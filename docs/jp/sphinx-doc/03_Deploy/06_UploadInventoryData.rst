構成管理DBからインベントリ収集結果の検索
----------------------------------------

getconfig -u db コマンドにより、各インベントリ収集結果はRedmine データベース
に蓄積されます。これらデータは、Redmine のプロジェクトメニュー「サーバ構成情報」
から検索します。

インベントリ検索
^^^^^^^^^^^^^^^^

構成収集作業PCで収集した結果をRedmineから検索をします。
Redmine画面右上のプロジェクト選択メニューから特定のプロジェクトを選択し、
プロジェクトメニューから「サーバ構成情報」を選択します。

   .. figure:: image/07_cmdb1.png
      :align: center
      :alt: CMDB1
      :width: 720px

.. note::

   本機能は「getconfig -u db」コマンドでRedmine データベースに登録した
   構成収集結果を検索します。

本メニューは収集したインベントリ情報のビューアーで、上段の
入力フィールドにキーワードを指定すると、その条件でインベントリ情報を検索します。

   .. figure:: image/07_cmdb2.png
      :align: center
      :alt: CMDB2
      :width: 720px

.. note::

   * 入力した値はワイルドカードで中間一致でキーワード検索します。
   * 未記入フィールドは、条件指定なしとなります。

デバイス検索
~~~~~~~~~~~~

画面右上のデバイス選択メニューから、デバイスを選択すると、そのデバイスの
詳細データを表示します。

   .. figure:: image/07_cmdb3.png
      :align: center
      :alt: CMDB3
      :width: 720px

本画面はディスク、ネットワークなど複数デバイスからなるインベントリの
検索画面となります。

   .. figure:: image/07_cmdb4.png
      :align: center
      :alt: CMDB4
      :width: 720px

前メニューに戻る場合は「戻る」をクリックします。

Redmineチケットとの関連付け
^^^^^^^^^^^^^^^^^^^^^^^^^^^

Redmineカスタムフィールドを用いて、上記インベントリ検索のURLとのリンク設定をします。
プロジェクトメニューの「チケット」から関連付けをしたい設備チケットを
選択してください。
「編集」をクリックして、チケットの編集画面の「インベントリ」フィールドに
設備チケットのホスト名を入力してください。
画面下の「送信」をクリックして、編集を完了してください。

再度、編集した設備チケットを選択し、「インベントリー」フィールドがリンク表示
されていることを確認してください。

   .. figure:: image/07_cmdb_ticket2.png
      :align: center
      :alt: CMDB Ticket2

本リンクをクリックすると、指定したホスト名のインベントリ情報の検索画面に移動します。
Redmineのカスタムフィールドで入力値を以下URLに変換して登録しています。

::

   http://{構成管理DBサーバ}/redmine/inventory?node=gittest
